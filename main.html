<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Spectrogram</title>
    <style>canvas { width: 100%; height: 100% }</style>
  </head>
  <body onload="start()">
    <canvas id="spectrogram"></canvas>
    <script id="fragmentShader" type="x-shader/x-fragment">
      varying highp vec2 vTextureCoord;

      uniform sampler2D uSampler;

      highp vec4 physicalColor(highp float amplitude) {
          highp float fractional = mod(amplitude*8.0, 1.0);
          highp float integer = floor(amplitude);
          if (integer == 0.0) {
              return vec4(amplitude, 0.0, 0.0, 1.0);
          } else if (integer == 1.0) {
              return vec4(1.0, amplitude, 0.0, 1.0);
          } else if (integer == 2.0) {
              return vec4(1.0-amplitude, 1.0, 0.0, 1.0);
          } else if (integer == 3.0) {
              return vec4(0.0, 1.0, amplitude, 1.0);
          } else if (integer == 4.0) {
              return vec4(0.0, 1.0-amplitude, 1.0, 1.0);
          } else if (integer == 5.0) {
              return vec4(amplitude, 0.0, 1.0, 1.0);
          } else if (integer == 6.0) {
              return vec4(1.0, 1.0-amplitude, 1.0, 1.0);
          } else {
              return vec4(1.0, 1.0, 1.0, 1.0);
          }
      }

      void main() {
          highp float amplitude = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t)).r;

          gl_FragColor = physicalColor(amplitude);
      }
    </script>
    <script id="vertexShader" type="x-shader/x-vertex">
      attribute vec2 aVertexPosition;
      attribute vec2 aTextureCoord;

      uniform mat3 mZoom;

      varying highp vec2 vTextureCoord;

      void main() {
          vec3 zoomedVertexPosition = vec3(aVertexPosition, 1.0) * mZoom;
          gl_Position = vec4(zoomedVertexPosition, 1.0);
          vTextureCoord = aTextureCoord;
      }
    </script>
    <script src="spectrogram.js"></script>
    <script src="communication.js"></script>
  </body>
</html>
